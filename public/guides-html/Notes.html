<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux How-To</title>
</head>

<body>
<h1>Notes</h1>
<p>After upgrading to 6 disks, this is where weâ€™re at. With Zpool create I wish to try the ata designations.</p>
<p>/dev/sdb wwn-0x5000c5007fa27c96 ata-ST500LT012-1DG142_S3PFF53T</p>
<p>/dev/sdc wwn-0x5000c500259d4d69 ata-ST9500420AS_5VJ6Z0Y1</p>
<p>/dev/sdd wwn-0x5000c5004a89f155 ata-ST9500423AS_6WR0R811</p>
<p>/dev/sde wwn-0x5000cca715c20e10 ata-APPLE_HDD_HTS547550A9E384_J2210056G4J48B</p>
<p>/dev/sdf wwn-0x5000cca8bcd66f7b ata-HGST_HTS725050A7E630_170514RCF50ACF1LB01N</p>
<p>/dev/sdk wwn-0x5000c5003839188d ata-ST9500420AS_5VJBLGRL</p>
<p>Such that command is:</p>
<pre><code>sudo zpool create -f fivebysix raidz1 \
/dev/disk/by-id/ata-ST500LT012-1DG142_S3PFF53T \
/dev/disk/by-id/ata-ST9500420AS_5VJ6Z0Y1 \
/dev/disk/by-id/ata-ST9500423AS_6WR0R811 \
/dev/disk/by-id/ata-APPLE_HDD_HTS547550A9E384_J2210056G4J48B \
/dev/disk/by-id/ata-HGST_HTS725050A7E630_170514RCF50ACF1LB01N \
/dev/disk/by-id/ata-ST9500420AS_5VJBLGRL
</code></pre>
<ol>
<li>Check ONSITE archive has copied across to ext hdd.</li>
<li>Create command to create new zpool with FIVE disk</li>
<li>Run it</li>
<li>Copy archive to the new zpool</li>
<li>Extract the archive on the zpool (x2 including decryption)</li>
</ol>
<p>P310 Thinkstation in corner of living room</p>
<p>ONE /dev/sdh usb-WD_My_Book_1140_5743415A4137343331303639</p>
<p>TWO /dev/sdi usb-WD_My_Book_1140_5743415A4143303038353431</p>
<p>sudo cryptsetup open /dev/sdi wd1 &amp;&amp; sudo mount -t ext4 /dev/mapper/wd1 /mnt/wd1-crypt/ &amp;&amp; sudo cryptsetup open /dev/sdf wd2 &amp;&amp; sudo mount -t ext4 /dev/mapper/wd2 /mnt/wd2-crypt/</p>
<p>Script to setup and mount a encrypted disk</p>
<p>sudo cryptsetup luksFormat /dev/sdi &amp;&amp; \</p>
<p>sudo cryptsetup open /dev/sdi wd2 &amp;&amp; \</p>
<p>sudo mkfs.ext4 /dev/mapper/wd2 &amp;&amp; \</p>
<p>sudo mount -t ext4 /dev/mapper/wd2 /mnt/wd2-crypt/</p>
<p>Extract gpg file, emphasising to prompt for passphrase</p>
<p>gpg --no-symkey-cache --output /mnt/raidz/xfer/wd1/ONSITE.tar.gz --decrypt ONSITE.tar.gz.gpg</p>
<p>Dungeon 10z2 + 1 Spare</p>
<p>sudo zpool create -f ten raidz2 \</p>
<p>/dev/disk/by-id/ata-WDC_WD5000AAKX-08U6AA0_WD-WMC2E8423318 \</p>
<p>/dev/disk/by-id/ata-WDC_WD5000AAKX-75U6AA0_WD-WMC2E0F7795J \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EEZLZ8 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EREDX8 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EREBQ5 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EREBG5 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_W3T4AQK8 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EREBA2 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_W3T4AQR0 \</p>
<p>/dev/disk/by-id/ata-ST500DM002-1BD142_Z6EREDD3 &amp;&amp; \</p>
<p>sudo zfs set mountpoint=/mnt/raidz ten &amp;&amp; \</p>
<p>sudo chown -R sven:sven /mnt/raidz &amp;&amp; \</p>
<p>sudo zpool add ten spare ata-ST500DM002-1BD142_Z6ERE9M5</p>
<p>Manly X370F</p>
<p>sda ata-TOSHIBA_MQ01ACF050_17NQTPDIT</p>
<p>sdb ata-WDC_WD5000BPKT-75PK4T0_WD-WX41A82Y0945</p>
<p>sudo apt update &amp;&amp; sudo apt upgrade -y &amp;&amp; sudo apt install zfsutils-linux -y &amp;&amp; \</p>
<p>sudo modprobe zfs &amp;&amp; \</p>
<p>sudo mkdir /mnt/two-z1 &amp;&amp; \</p>
<p>sudo zpool create -f two raidz1 \</p>
<p>/dev/disk/by-id/ata-TOSHIBA_MQ01ACF050_17NQTPDIT \</p>
<p>/dev/disk/by-id/ata-WDC_WD5000BPKT-75PK4T0_WD-WX41A82Y0945 &amp;&amp; \</p>
<p>sudo zfs set mountpoint=/mnt/two-z1 two &amp;&amp; \</p>
<p>sudo chown -R sven:sven /mnt/two-z1</p>
<p>sudo mkdir /mnt/raidz &amp;&amp; \</p>
<p>sudo zpool create -f four raidz1 \</p>
<p>/dev/disk/by-id/ata-SAMSUNG_HD103SI_S210JDWSB05651 \</p>
<p>/dev/disk/by-id/ata-ST1000DM003-1SB102_Z9AAM2W5 \</p>
<p>/dev/disk/by-id/ata-ST31000524AS_5VP7QZAG \</p>
<p>/dev/disk/by-id/ata-WDC_WD10EZEX-08WN4A0_WD-WCC6Y7UTUT8P &amp;&amp; \</p>
<p>sudo zfs set mountpoint=/mnt/raidz four &amp;&amp; \</p>
<p>sudo chown -R sven:sven /mnt/raidz</p>
<p>Create archive</p>
<p>tar -cvzf folder.tar.gz folder</p>
<p>Extract archive</p>
<p>tar -xvf crap.tar.gz -C ~/</p>
<p>Decompress xz, keep original, force, verbose</p>
<p>xz -vdkf ~/crap.tar.xz</p>
<p>Create Python virtualenv</p>
<p>This no longer seems to work. Need to use venv instead of virtualenv</p>
<pre><code>sudo apt install python3-pip -y &amp;&amp;
mkdir ~/scripts &amp;&amp;
python3 -m pip install virtualenv &amp;&amp;
python3 -m virtualenv ~/scripts/sqlcon &amp;&amp;
source ~/scripts/sqlcon/bin/activate &amp;&amp;
python -m pip install mysql-connector-python
</code></pre>

</body>

</html>